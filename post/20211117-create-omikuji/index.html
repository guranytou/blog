<!doctype html><html lang=ja-jp>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>簡易なおみくじができるCLIを作った - しゅがーぽっと</title>
<meta name=description content="前書き Goの勉強をするのにスナック感覚でCLIを作ろうその１として、よくあるおみくじCLIを作りました。
math/randのお勉強も兼ねてます。
書いたコード 置き場所 https://github.com/guranytou/GoStudy/tree/master/omikuji
コード package main import ( &#34;fmt&#34; &#34;log&#34; &#34;math/rand&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/urfave/cli/v2&#34; ) func main() { app := cli.NewApp() app.Name = &#34;omikuji&#34; app.Usage = &#34;Play omikuji&#34; app.Version = &#34;0.0.1&#34; app.Action = func(c *cli.Context) error { omikuji() return nil } err := app.Run(os.Args) if err != nil { log.Fatal(err) } } func omikuji() { rand.Seed(time.Now().UnixNano()) luck := rand.Intn(12) switch luck { case 0: fmt.Println(&#34;大吉&#34;) case 1, 2: fmt.">
<meta name=author content="guranytou">
<link rel="preload stylesheet" as=style href=https://guranytou.github.io/blog/app.min.css>
<link rel="preload stylesheet" as=style href=https://guranytou.github.io/blog/an-old-hope.min.css>
<script defer src=https://guranytou.github.io/blog/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=https://guranytou.github.io/blog/theme.png>
<link rel=preload as=image href=https://guranytou.github.io/blog/twitter.svg>
<link rel=preload as=image href=https://guranytou.github.io/blog/github.svg>
<link rel=icon href=https://guranytou.github.io/blog/favicon.ico>
<link rel=apple-touch-icon href=https://guranytou.github.io/blog/apple-touch-icon.png>
<meta name=generator content="Hugo 0.88.0">
<meta property="og:title" content="簡易なおみくじができるCLIを作った">
<meta property="og:description" content="前書き Goの勉強をするのにスナック感覚でCLIを作ろうその１として、よくあるおみくじCLIを作りました。
math/randのお勉強も兼ねてます。
書いたコード 置き場所 https://github.com/guranytou/GoStudy/tree/master/omikuji
コード package main import ( &#34;fmt&#34; &#34;log&#34; &#34;math/rand&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/urfave/cli/v2&#34; ) func main() { app := cli.NewApp() app.Name = &#34;omikuji&#34; app.Usage = &#34;Play omikuji&#34; app.Version = &#34;0.0.1&#34; app.Action = func(c *cli.Context) error { omikuji() return nil } err := app.Run(os.Args) if err != nil { log.Fatal(err) } } func omikuji() { rand.Seed(time.Now().UnixNano()) luck := rand.Intn(12) switch luck { case 0: fmt.Println(&#34;大吉&#34;) case 1, 2: fmt.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://guranytou.github.io/blog/post/20211117-create-omikuji/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-11-17T00:35:15+09:00">
<meta property="article:modified_time" content="2021-11-17T00:35:15+09:00">
<meta itemprop=name content="簡易なおみくじができるCLIを作った">
<meta itemprop=description content="前書き Goの勉強をするのにスナック感覚でCLIを作ろうその１として、よくあるおみくじCLIを作りました。
math/randのお勉強も兼ねてます。
書いたコード 置き場所 https://github.com/guranytou/GoStudy/tree/master/omikuji
コード package main import ( &#34;fmt&#34; &#34;log&#34; &#34;math/rand&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/urfave/cli/v2&#34; ) func main() { app := cli.NewApp() app.Name = &#34;omikuji&#34; app.Usage = &#34;Play omikuji&#34; app.Version = &#34;0.0.1&#34; app.Action = func(c *cli.Context) error { omikuji() return nil } err := app.Run(os.Args) if err != nil { log.Fatal(err) } } func omikuji() { rand.Seed(time.Now().UnixNano()) luck := rand.Intn(12) switch luck { case 0: fmt.Println(&#34;大吉&#34;) case 1, 2: fmt."><meta itemprop=datePublished content="2021-11-17T00:35:15+09:00">
<meta itemprop=dateModified content="2021-11-17T00:35:15+09:00">
<meta itemprop=wordCount content="120">
<meta itemprop=keywords content="Go,">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="簡易なおみくじができるCLIを作った">
<meta name=twitter:description content="前書き Goの勉強をするのにスナック感覚でCLIを作ろうその１として、よくあるおみくじCLIを作りました。
math/randのお勉強も兼ねてます。
書いたコード 置き場所 https://github.com/guranytou/GoStudy/tree/master/omikuji
コード package main import ( &#34;fmt&#34; &#34;log&#34; &#34;math/rand&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/urfave/cli/v2&#34; ) func main() { app := cli.NewApp() app.Name = &#34;omikuji&#34; app.Usage = &#34;Play omikuji&#34; app.Version = &#34;0.0.1&#34; app.Action = func(c *cli.Context) error { omikuji() return nil } err := app.Run(os.Args) if err != nil { log.Fatal(err) } } func omikuji() { rand.Seed(time.Now().UnixNano()) luck := rand.Intn(12) switch luck { case 0: fmt.Println(&#34;大吉&#34;) case 1, 2: fmt.">
</head>
<body class=not-ready data-menu=true>
<header class=header>
<p class=logo>
<a class=site-name href=https://guranytou.github.io/blog/>しゅがーぽっと</a><a class=btn-dark></a>
</p>
<script>let bodyClx=document.body.classList,btnDark=document.querySelector('.btn-dark'),sysDark=window.matchMedia('(prefers-color-scheme: dark)'),darkVal=localStorage.getItem('dark'),setDark=a=>{bodyClx[a?'add':'remove']('dark'),localStorage.setItem('dark',a?'yes':'no')};setDark(darkVal?darkVal==='yes':sysDark.matches),requestAnimationFrame(()=>bodyClx.remove('not-ready')),btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark'))),sysDark.addEventListener('change',a=>setDark(a.matches))</script>
<nav class=menu>
<a href=/blog/resume/></a>
<a href=/blog/about/>About</a>
</nav>
<nav class=social>
<a class=twitter style=--url:url(./twitter.svg) href=https://twitter.com/gurany_tou target=_blank></a>
<a class=github style=--url:url(./github.svg) href=https://github.com/guranytou target=_blank></a>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-title>
<aside>
<time>November 17, 2021</time>
<span>guranytou</span>
</aside>
<h1>簡易なおみくじができるCLIを作った</h1>
</header>
<section class=post-content><h2 id=前書き>前書き</h2>
<p>Goの勉強をするのにスナック感覚でCLIを作ろうその１として、よくあるおみくじCLIを作りました。<br>
<code>math/rand</code>のお勉強も兼ねてます。</p>
<h2 id=書いたコード>書いたコード</h2>
<h3 id=置き場所>置き場所</h3>
<p><a href=https://github.com/guranytou/GoStudy/tree/master/omikuji>https://github.com/guranytou/GoStudy/tree/master/omikuji</a></p>
<h3 id=コード>コード</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang:main.go data-lang=golang:main.go><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

<span style=color:#f92672>import</span> (
	<span style=color:#e6db74>&#34;fmt&#34;</span>
	<span style=color:#e6db74>&#34;log&#34;</span>
	<span style=color:#e6db74>&#34;math/rand&#34;</span>
	<span style=color:#e6db74>&#34;os&#34;</span>
	<span style=color:#e6db74>&#34;time&#34;</span>

	<span style=color:#e6db74>&#34;github.com/urfave/cli/v2&#34;</span>
)

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
	<span style=color:#a6e22e>app</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>cli</span>.<span style=color:#a6e22e>NewApp</span>()
	<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>Name</span> = <span style=color:#e6db74>&#34;omikuji&#34;</span>
	<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>Usage</span> = <span style=color:#e6db74>&#34;Play omikuji&#34;</span>
	<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>Version</span> = <span style=color:#e6db74>&#34;0.0.1&#34;</span>
	<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>Action</span> = <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>cli</span>.<span style=color:#a6e22e>Context</span>) <span style=color:#66d9ef>error</span> {
		<span style=color:#a6e22e>omikuji</span>()
		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
	}

	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>Run</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Args</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
	}
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>omikuji</span>() {
	<span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Seed</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>UnixNano</span>())
	<span style=color:#a6e22e>luck</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(<span style=color:#ae81ff>12</span>)
	<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>luck</span> {
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>0</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;大吉&#34;</span>)
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;中吉&#34;</span>)
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;小吉&#34;</span>)
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;末吉&#34;</span>)
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;吉&#34;</span>)
	<span style=color:#66d9ef>case</span> <span style=color:#ae81ff>11</span>:
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;凶&#34;</span>)
	}
}
</code></pre></div><p>難しいことをせずにをモットーに作ったので、色々ベタ書きです。<br>
<code>omikuji()</code>はそのうちリファクタリングしたいなあ（願望）。</p>
<h3 id=表示結果>表示結果</h3>
<pre tabindex=0><code>$ omikuji
大吉
</code></pre><p>普通に実行したら大吉が出ました。やったね。</p>
<h2 id=mathrandについて><code>math/rand</code>について</h2>
<h3 id=mathrandを使った理由><code>math/rand</code>を使った理由</h3>
<p>Goで乱数生成に関する標準パッケージには<code>math/rand</code>と<code>crypto/rand</code>の2つがあります。<br>
今回はともかくサクッと軽いCLIが作りたかったので、<code>math/rand</code>を選択しました。<br>
セキュアなものを作りたければ<code>crypto/rand</code>を利用した方が良さそうです。</p>
<h3 id=mathrandの簡単な解説><code>math/rand</code>の簡単な解説</h3>
<p>乱数生成のためにはシード値を生成する必要があるので、時間を利用して作成します。<br>
※シード値生成に時間を利用するのはよくある話なので割愛します。</p>
<pre tabindex=0><code>rand.Seed(time.Now().UnixNano())
</code></pre><p>今回はswitchを利用しておみくじを振り分けていきたいので、<code>rand.Intn()</code>で、 0 &lt;= n &lt; 12の数をランダムに生成します。<br>
<code>rand.Intn(x)</code>と書くと、0以上xまでのInt型の値を生成します。</p>
<h3 id=参考にしたページ>参考にしたページ</h3>
<p><a href=https://xn--go-hh0g6u.com/pkg/math/rand/>https://xn--go-hh0g6u.com/pkg/math/rand/</a><br>
<a href=https://qiita.com/crifff/items/b116e6235fedcd18e0de>https://qiita.com/crifff/items/b116e6235fedcd18e0de</a></p>
<h2 id=まとめ>まとめ</h2>
<p>今回は乱数生成方法について勉強&整理しました。<br>
実際によく使うのは<code>crypto/rand</code>なのかなあという気もするので、次回乱数生成することがあったらそちらを使おうかなと思います。</p>
</section>
<footer class=post-tags>
<a href=https://guranytou.github.io/blog/tags/go>Go</a>
</footer>
<nav class=post-nav>
<a class=next href=https://guranytou.github.io/blog/post/20211116urfave-cli-tutorial/><span>urfave/cliのチュートリアルをやってみた</span><span>→</span></a>
</nav>
</article>
</main>
<footer class=footer>
<p>&copy; 2021 <a href=https://guranytou.github.io/blog/>しゅがーぽっと</a></p>
<p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p>
<p>
<a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.0</a>
</p>
</footer>
</body>
</html>